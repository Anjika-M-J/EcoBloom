{% extends 'User/Head.html' %}
{% block content %}

<style>
    body {
        background-color: #f4f6f9;
    }

    .page-title {
        text-align: center;
        font-size: 26px;
        font-weight: 600;
        margin: 30px 0;
        color: #2c3e50;
    }

    table {
        width: 70%;
        margin: auto;
        border-collapse: collapse;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 6px 15px rgba(0,0,0,0.08);
    }

    table th {
        background: #2ecc71;
        color: white;
        padding: 12px;
        text-align: center;
    }

    table td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #eee;
    }

    table tr:hover {
        background-color: #eafaf1;
    }

    .chart-container {
        width: 70%;
        margin: 40px auto;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 6px 15px rgba(0,0,0,0.08);
    }
</style>

<div class="page-title">
    My Waste Collection Report (Category-wise)
</div>

<table>
    <tr>
        <th>Waste Category</th>
        <th>Total Waste Given (kg)</th>
    </tr>

    {% for i in report %}
    <tr>
        <td>{{ i.wastecategory_id__wastecategory_name }}</td>
        <td>{{ i.total_qty }}</td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="2">No waste records available</td>
    </tr>
    {% endfor %}
</table>

{% if report %}
<div class="chart-container">
    <canvas id="userChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const labels = [
        {% for i in report %}
            "{{ i.wastecategory_id__wastecategory_name }}"{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];

    const dataValues = [
        {% for i in report %}
            {{ i.total_qty }}{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];

    new Chart(document.getElementById('userChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Waste Given (kg)',
                data: dataValues,
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>
{% endif %}

{% endblock %}
